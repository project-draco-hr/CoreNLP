{
  double prob=0;
  double[][] weights=to2D(x,xscale);
  for (  int ind : batch) {
    prob+=valueForADoc(weights,ind);
  }
  if (Double.isNaN(prob)) {
    throw new RuntimeException("Got NaN for prob in CRFLogConditionalObjectiveFunction.calculate()");
  }
  value=-prob;
  return value;
}
