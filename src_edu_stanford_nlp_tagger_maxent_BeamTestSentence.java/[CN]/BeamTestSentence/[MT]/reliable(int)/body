{
  int numTags=maxentTagger.tags.getSize();
  double[][][] probabilities=new double[size][kBestSize][numTags];
  calculateProbs(probabilities);
  String tag=nBest[0][current];
  int y=maxentTagger.tags.getIndex(tag);
  double max=0;
  int maxInd=-1;
  double p=probabilities[current][0][y];
  if (!maxentTagger.dict.isUnknown(sent.get(current))) {
    System.out.println(" known " + sent.get(current));
    String[] tags=maxentTagger.dict.getTags(sent.get(current));
    String[] tags1=maxentTagger.tags.deterministicallyExpandTags(tags);
    for (    String aTags1 : tags1) {
      int i=maxentTagger.tags.getIndex(aTags1);
      if (i == y) {
        continue;
      }
      if ((probabilities[current][0][i] >= max) && (probabilities[current][0][i] <= p)) {
        max=probabilities[current][0][i];
        maxInd=i;
      }
    }
  }
 else {
    System.out.println(" unknown " + sent.get(current));
    for (int i=0; i < maxentTagger.ySize; i++) {
      if (i == y) {
        continue;
      }
      if ((probabilities[current][0][i] >= max) && (probabilities[current][0][i] <= p)) {
        max=probabilities[current][0][i];
        maxInd=i;
      }
    }
  }
  if (maxInd == -1) {
    return true;
  }
  String tag1=maxentTagger.tags.getTag(maxInd);
  System.out.println(tag + ' ' + maxentTagger.tags.getTag(maxInd)+ ' '+ p / max);
  if (maxentTagger.dict.isUnknown(sent.get(current)) && (maxentTagger.tags.isClosed(tag1))) {
    return true;
  }
 else {
    return (p / max) > sigma;
  }
}
