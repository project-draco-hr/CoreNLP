{
  int n=0;
  for (int feat=0; feat < weights.length; feat++) {
    for (    int labIndex : iLabels) {
      double thisWeight=(useMagnitude) ? Math.abs(weights[feat][labIndex]) : weights[feat][labIndex];
      if (thisWeight > threshold) {
        n++;
      }
    }
  }
  return n;
}
