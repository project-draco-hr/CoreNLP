{
  if (example instanceof RVFDatum<?,?>) {
    throw new UnsupportedOperationException();
  }
  int labelCount=weights[0].length;
  Collection<F> features=example.asFeatures();
  int[] featureInts=new int[features.size()];
  int fI=0;
  for (  F feature : features) {
    featureInts[fI++]=featureIndex.indexOf(feature);
  }
  double bestScore=Double.NEGATIVE_INFINITY;
  int bestI=0;
  for (int i=0; i < labelCount; i++) {
    double score=0;
    for (int j=0; j < featureInts.length; j++) {
      if (featureInts[j] < 0)       continue;
      score+=weights[featureInts[j]][i];
    }
    if (score > bestScore) {
      bestI=i;
      bestScore=score;
    }
  }
  return labelIndex.get(bestI);
}
