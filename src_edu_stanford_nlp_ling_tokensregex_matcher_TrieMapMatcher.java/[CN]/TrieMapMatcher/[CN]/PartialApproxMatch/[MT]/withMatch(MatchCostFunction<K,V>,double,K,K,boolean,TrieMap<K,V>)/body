{
  PartialApproxMatch<K,V> res=withMatch(costFunction,deltaCost,t,k);
  if (multimatch && matched != null && res.value != null) {
    if (res.multivalues == null) {
      res.multivalues=new ArrayList<V>(1);
    }
 else {
      res.multivalues=new ArrayList<V>(multivalues.size() + 1);
      res.multivalues.addAll(multivalues);
    }
    res.multivalues.add(res.value);
    if (res.multimatched == null) {
      res.multimatched=new ArrayList<List<K>>(1);
    }
 else {
      res.multimatched=new ArrayList<List<K>>(multimatched.size() + 1);
      res.multimatched.addAll(multimatched);
    }
    res.multimatched.add(matched.subList(lastMultimatchedStartIndex,matched.size()));
    res.cost+=costFunction.multiMatchDeltaCost(res.multimatched.get(res.multimatched.size() - 1),res.value,res.multimatched.size());
    res.lastMultimatchedStartIndex=matched.size();
    res.trie=root;
  }
  return res;
}
