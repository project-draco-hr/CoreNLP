{
  LikelihoodFunction df=new LikelihoodFunction(prob,tol,useGaussianPrior,priorSigmaS,sigmaSquareds);
  MonitorFunction monitor=new MonitorFunction(prob,df,filename);
  Minimizer<DiffFunction> cgm=new QNMinimizer(monitor,10);
  ((QNMinimizer)cgm).useOWLQN(true,weight);
  double[] result=cgm.minimize(df,tol,new double[df.domainDimension()]);
  prob.lambda=result;
  monitor.reportMonitoring(df.valueAt(result));
  System.err.println("after optimization value is " + df.valueAt(result));
}
