{
  double charSequenceCount=charSequenceCounts[category].getCount(charSequence);
  if (charSequenceCount == 0) {
    return (0);
  }
  double historyCount;
  if (charSequence.length() == 1) {
    historyCount=charTotalCounts[category];
  }
 else {
    String history=charSequence.substring(0,charSequence.length() - 1);
    historyCount=charSequenceCounts[category].getCount(history);
    if (historyCount == 0) {
      if (DEBUG) {
        System.err.println("*** NULL HISTORY COUNT: [" + charSequence + "] #c="+ charSequenceCount);
      }
      return (0);
    }
  }
  return (charSequenceCount / historyCount);
}
