{
  double n=evidence.totalCount();
  if (n == 0.0) {
    return this;
  }
  Matrix res=var;
  for (  Map.Entry<Vector,Double> x : evidence.entrySet()) {
    Matrix xfix=new DenseMatrix(x.getKey().copy().add(-1,likelihoodMean));
    res=xfix.transBmultAdd(x.getValue(),xfix,res);
  }
  return new GaussianCovariancePrior(df + n,res,likelihoodMean);
}
