{
  SequenceModel model=getModel(doc);
  KBestSequenceFinder tagInference=new KBestSequenceFinder();
  Counter<int[]> bestSequences=tagInference.kBestSequences(model,k);
  Counter<Pair<List<CoreLabel>,Counter<Integer>>> kBest=new ClassicCounter<Pair<List<CoreLabel>,Counter<Integer>>>();
  for (  int[] seq : bestSequences.keySet()) {
    List<CoreLabel> kth=new ArrayList<CoreLabel>();
    int pos=model.leftWindow();
    for (    CoreLabel fi : doc) {
      CoreLabel newFL=new CoreLabel(fi);
      String guess=(String)metaInfo.getLabel(seq[pos]);
      fi.remove(AnswerAnnotation.class);
      newFL.set(answerField,guess);
      pos++;
    }
    Counter<Integer> features=((CRF)model).getFeatures(seq);
    System.err.println("=================================================\n" + features);
    kBest.setCount(new Pair<List<CoreLabel>,Counter<Integer>>(kth,features),bestSequences.getCount(seq));
  }
  return kBest;
}
