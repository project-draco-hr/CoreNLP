{
  if (flags.useObservedSequencesOnly) {
    Collection<LabeledClique> observedSequences=observedSequences(train.iterator(),metaInfo);
    metaInfo.setAllowedSequences(observedSequences);
  }
  MultiDocumentCliqueDataset dataset=new MultiDocumentCliqueDataset(metaInfo,flags,train);
  MultiDocumentCliqueDataset testset=(test != null) ? new MultiDocumentCliqueDataset(metaInfo,flags,test) : null;
  Interner.getGlobal().clear();
  dataset.metaInfo().fm.makeFaster();
  PrintWriter pw=new PrintWriter(System.err,true);
  dataset.printStats(pw);
  train(dataset,testset,adapt);
}
