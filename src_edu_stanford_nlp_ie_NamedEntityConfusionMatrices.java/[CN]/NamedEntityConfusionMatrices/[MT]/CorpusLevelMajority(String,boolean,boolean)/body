{
  BufferedReader br=new BufferedReader(new FileReader(file));
  HashMap<String,int[]> entities=namedEntitiesLabelCounts(br,true,1,3,ignoreCase,entityLevel);
  br.close();
  int tokenColumn=1;
  int labelColumn=3;
  br=new BufferedReader(new FileReader(file));
  String line;
  String entitySoFar="", prevEntityLabel="";
  int lineNo=0;
  while ((line=br.readLine()) != null) {
    lineNo++;
    String word=entryAtColumnNumber(line,tokenColumn);
    String currEntityLabel=entryAtColumnNumber(line,labelColumn);
    if (currEntityLabel.equals("O") || currEntityLabel.equals("")) {
      if (lineNo > 1)       printMajority(entities,entitySoFar,prevEntityLabel,ignoreCase);
      entitySoFar=word;
      prevEntityLabel=currEntityLabel;
    }
 else     if (sameEntity(prevEntityLabel,currEntityLabel,entityLevel)) {
      entitySoFar=entitySoFar + "~" + word;
      prevEntityLabel=currEntityLabel;
    }
 else {
      if (lineNo > 1)       printMajority(entities,entitySoFar,prevEntityLabel,ignoreCase);
      entitySoFar=word;
      prevEntityLabel=currEntityLabel;
    }
  }
  printMajority(entities,entitySoFar,prevEntityLabel,ignoreCase);
  br.close();
}
