{
  int start=length - 3;
  if (start < 0)   start=0;
  TreebankLanguagePack tlp=op.tlpParams.treebankLanguagePack();
  for (int i=length - 1; i >= start; i--) {
    Object item=sentence.get(i);
    String tag=null;
    if (item instanceof HasTag) {
      tag=((HasTag)item).tag();
    }
    if (tag != null && !"".equals(tag)) {
      if (tlp.isSentenceFinalPunctuationTag(tag)) {
        return;
      }
    }
 else     if (item instanceof HasWord) {
      String str=((HasWord)item).word();
      if (tlp.isPunctuationWord(str)) {
        return;
      }
    }
 else {
      String str=item.toString();
      if (tlp.isPunctuationWord(str)) {
        return;
      }
    }
  }
  if (op.testOptions.verbose) {
    System.err.println("Adding missing final punctuation to sentence.");
  }
  String[] sfpWords=tlp.sentenceFinalPunctuationWords();
  if (sfpWords.length > 0) {
    sentence.add(new Word(sfpWords[0]));
  }
}
