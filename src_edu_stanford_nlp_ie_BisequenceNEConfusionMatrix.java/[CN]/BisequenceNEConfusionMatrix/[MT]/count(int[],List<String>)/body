{
  List<Entity> entities=BisequenceEmpiricalNERPrior.extractEntities(sequence,wordDoc,tagIndex,classIndex,backgroundSymbolIndex);
  for (  Entity curr : entities) {
    int tag1=curr.type;
    for (    Entity match : curr.exactMatch) {
      int tag2=match.type;
      entityMatrix[tag1][tag2]++;
      entityMatrix[tag2][tag1]++;
    }
    for (    Entity match : curr.subMatch) {
      int tag2=match.type;
      subEntityMatrix[tag1][tag2]++;
    }
  }
}
