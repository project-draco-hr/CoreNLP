{
  if (verbose > 1)   System.err.println("Sampling beta");
  ClassicCounter<Integer> params=new ClassicCounter<Integer>();
  for (  int parent : m.firstKeySet()) {
    ClassicCounter<Integer> tableCounts=m.getCounter(parent);
    for (    int dish : tableCounts.keySet()) {
      double numTables=tableCounts.getCount(dish);
      params.incrementCount(dish,numTables);
    }
  }
  params.incrementCount(UNSEEN,gamma);
  Multinomial<Integer> dist=Dirichlet.drawSample(random,params);
  beta=new ClassicCounter<Integer>();
  for (  int k : params.keySet()) {
    beta.setCount(k,dist.probabilityOf(k));
  }
  if (verbose > 1)   System.err.println("done. beta=" + beta);
}
