{
  ConjugatePrior posterior=posteriors.get(k);
  if (posterior == null) {
    posterior=prior;
    posteriors.put(k,prior);
  }
  double emissionProb=posterior.getPredictiveLogProbability(obs);
  if (Double.isNaN(emissionProb))   throw new RuntimeException("emissionProb=" + emissionProb + " "+ Arrays.toString((double[])obs)+ " "+ posterior);
  if (emissionProb == Double.NEGATIVE_INFINITY)   System.err.println("Zero emission prob!!");
  return emissionProb;
}
