{
  for (int i=1; i < observations.size() - 1; i++) {
    E e=observations.get(i);
    if (e == boundarySymbol) {
      if (firstPass)       updateCounts(i,1.0,false,false);
    }
 else {
      if (!firstPass)       updateCounts(i,-1.0,true,true);
      sampleZ(i,firstPass);
      updateCounts(i,1.0,!firstPass,true);
    }
    if (i % 100 == 0 && verbose > 0)     System.err.print(".");
  }
  if (verbose > 0)   System.err.println();
}
