{
  File file;
  if (batchMode) {
    String targetFile=targetDir + File.separator + curFile.getName();
    file=new File(targetFile);
  }
 else   if (!overwrite || curFile == null) {
    if (fc.showSaveDialog(this) == JFileChooser.APPROVE_OPTION) {
      file=fc.getSelectedFile();
    }
 else {
      return false;
    }
  }
 else {
    file=curFile;
  }
  if (file != null) {
    saveFile(file);
    return true;
  }
  return false;
}
