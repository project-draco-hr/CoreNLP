{
  int val=fc.showSaveDialog(this);
  if (val == JFileChooser.APPROVE_OPTION) {
    File file=fc.getSelectedFile();
    FileWriter out=null;
    try {
      out=new FileWriter(file);
      for (int i=0; i < tags.size(); i++) {
        String contents=tags.elementAt(i);
        if (saveColor) {
          SimpleAttributeSet attr=colorMaps.get(contents);
          Color c=StyleConstants.getForeground(attr);
          contents+="\t" + Integer.toString(c.getRed()) + "\t"+ Integer.toString(c.getGreen())+ "\t"+ Integer.toString(c.getBlue());
        }
        contents+="\n";
        out.write(contents);
      }
      out.close();
      tagsChanged=false;
      return true;
    }
 catch (    IOException e) {
      errorMessage("There was a problem saving the tag file");
      if (out != null) {
        try {
          out.close();
        }
 catch (        IOException ioe) {
        }
      }
    }
  }
  return false;
}
