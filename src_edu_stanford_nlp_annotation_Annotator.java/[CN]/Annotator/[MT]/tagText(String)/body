{
  SimpleAttributeSet attr=colorMaps.get(com);
  if (attr != null) {
    String st=tp.getSelectedText();
    taggedStrings.add(new TaggedString(st,com));
    if (st != null && st.length() > 0 && checkSelection(st)) {
      try {
        tp.replaceSelection("");
        int selectionStart=tp.getSelectionStart();
        String startTag="<tag name=\"" + com + "\" value=\"start\"/>";
        String endTag="<tag name=\"" + com + "\" value=\"end\"/>";
        doc.insertString(selectionStart,startTag + st + endTag,attr);
        tp.setCaretPosition(selectionStart + startTag.length() + st.length()+ endTag.length());
        tp.requestFocus();
      }
 catch (      BadLocationException ex) {
      }
    }
  }
}
