{
  if (arg1 == null) {
    return new RelativeTime(PREV_IMMEDIATE,arg2);
  }
  if (arg2 == null) {
    return arg1;
  }
  if (arg1 instanceof Time) {
    Time t=(Time)arg1;
    if (arg2 instanceof Duration) {
      return ((Duration)arg2).toTime(t,flags | RESOLVE_TO_PAST);
    }
 else {
      Temporal resolvedThis=arg2.resolve(t,RESOLVE_TO_PAST);
      if (resolvedThis != null) {
        if (resolvedThis instanceof Time) {
          if (((Time)resolvedThis).compareTo(t) >= 0) {
            return PREV.apply(arg1,arg2);
          }
        }
      }
      return resolvedThis;
    }
  }
 else {
    throw new UnsupportedOperationException("PREV_IMMEDIATE not implemented for arg1=" + arg1.getClass() + ", arg2="+ arg2.getClass());
  }
}
