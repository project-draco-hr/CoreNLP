{
  MatchedExpression.SingleAnnotationExtractor annotationExtractor=createAnnotationExtractor(env,r);
  SequenceMatchResultExtractor<CoreMap> valueExtractor=new SequenceMatchResultExtractor<>(env,action,result);
  SequencePatternExtractRule<CoreMap,Value> valueExtractRule=new SequencePatternExtractRule<>(pattern,valueExtractor,r.matchFindType,r.matchWithResults);
  SequenceMatchedExpressionExtractor exprExtractor=new SequenceMatchedExpressionExtractor(annotationExtractor,r.matchedExpressionGroup);
  SequencePatternExtractRule<CoreMap,MatchedExpression> exprExtractRule=new SequencePatternExtractRule<>(pattern,exprExtractor,r.matchFindType,r.matchWithResults);
  annotationExtractor.valueExtractor=new CoreMapFunctionApplier<>(env,r.annotationField,valueExtractRule);
  r.extractRule=exprExtractRule;
  r.filterRule=new AnnotationMatchedFilter(annotationExtractor);
  r.pattern=pattern;
  r.result=result;
  pattern.weight=r.weight;
  pattern.priority=r.priority;
}
