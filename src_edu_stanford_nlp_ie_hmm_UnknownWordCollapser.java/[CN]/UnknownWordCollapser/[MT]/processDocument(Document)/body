{
  Set vocab=corpusVocab;
  if (vocab == null) {
    Corpus c=new Corpus(new String[]{"(Background)"});
    TypedTaggedDocument ttd=new TypedTaggedDocument();
    Iterator iter=in.iterator();
    while (iter.hasNext()) {
      ttd.add(new TypedTaggedWord(((Word)iter.next()).word(),0));
    }
    c.add(ttd);
    vocab=Counters.keysAbove(c.getVocab(),(getMaxUnknownFrequency() + 1));
  }
  Document out=in.blankDocument();
  Iterator iter=in.iterator();
  while (iter.hasNext()) {
    TypedTaggedWord ttw=(TypedTaggedWord)iter.next();
    if (vocab.contains(ttw.word()) || ttw.word().startsWith(unknownWord)) {
      out.add(ttw);
    }
 else {
      String unkText=unknownWord;
      if (featuralDecomp) {
        unkText+=f.getValue(ttw.word());
      }
      out.add(new TypedTaggedWord(unkText,ttw.type()));
    }
  }
  return (out);
}
