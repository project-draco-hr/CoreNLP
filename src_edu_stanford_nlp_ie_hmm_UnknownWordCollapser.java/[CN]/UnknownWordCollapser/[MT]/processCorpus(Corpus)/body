{
  boolean localVocab=false;
  if (corpusVocab == null) {
    corpusVocab=Counters.keysAbove(in.getVocab(),(getMaxUnknownFrequency() + 1));
    localVocab=true;
  }
  Corpus out=new Corpus(in.getTargetFields());
  for (int i=0; i < in.size(); i++) {
    out.add(processDocument((Document)in.get(i)));
  }
  if (localVocab) {
    corpusVocab=null;
  }
  return (out);
}
