{
  int min=root.index();
  int max=root.index();
  Queue<IndexedWord> fringe=new LinkedList<>();
  for (  SemanticGraphEdge edge : tree.getOutEdgesSorted(root)) {
    String edgeLabel=edge.getRelation().getShortName();
    if ((validArcs == null || validArcs.contains(edgeLabel)) && !"punct".equals(edgeLabel)) {
      fringe.add(edge.getDependent());
    }
  }
  while (!fringe.isEmpty()) {
    IndexedWord node=fringe.poll();
    min=Math.min(node.index(),min);
    max=Math.max(node.index(),max);
    for (    SemanticGraphEdge edge : tree.getOutEdgesSorted(node)) {
      if (edge.getGovernor().equals(node) && !(edge.getGovernor().equals(edge.getDependent())) && !"punct".equals(edge.getRelation().getShortName())) {
        fringe.add(edge.getDependent());
      }
    }
  }
  return Pair.makePair(min,max + 1);
}
