{
  final long start=System.nanoTime();
  long numTokens=0;
  int numFiles=inputFileList.size();
  if (numFiles == 0) {
    BufferedReader stdin=new BufferedReader(new InputStreamReader(System.in,charset));
    BufferedWriter writer=new BufferedWriter(new OutputStreamWriter(System.out,charset));
    for (String line; (line=stdin.readLine()) != null; ) {
      numTokens+=tokReader(new StringReader(line),writer,parseInsideBegin,parseInsideEnd,options,preserveLines,dump,lowerCase);
      if (preserveLines)       writer.newLine();
    }
    IOUtils.closeIgnoringExceptions(writer);
  }
 else {
    for (int j=0; j < numFiles; j++) {
      Reader r=IOUtils.readReaderFromString(inputFileList.get(j),charset);
      BufferedWriter out=(outputFileList == null) ? new BufferedWriter(new OutputStreamWriter(System.out,charset)) : new BufferedWriter(new OutputStreamWriter(new FileOutputStream(outputFileList.get(j)),charset));
      numTokens+=tokReader(r,out,parseInsideBegin,parseInsideEnd,options,preserveLines,dump,lowerCase);
      r.close();
      IOUtils.closeIgnoringExceptions(out);
    }
  }
  final long duration=System.nanoTime() - start;
  final double wordsPerSec=(double)numTokens / ((double)duration / 1000000000.0);
  System.err.printf("PTBTokenizer tokenized %d tokens at %.2f tokens per second.%n",numTokens,wordsPerSec);
}
