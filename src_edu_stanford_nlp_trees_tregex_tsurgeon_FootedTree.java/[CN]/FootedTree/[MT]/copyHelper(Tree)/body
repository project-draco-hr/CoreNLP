{
  if (node.isLeaf()) {
    if (node == foot) {
      Tree clone=node.treeFactory().newTreeNode(node.label(),new ArrayList<Tree>(0));
      return new Pair<Tree,Tree>(clone,clone);
    }
 else     return new Pair<Tree,Tree>(node.treeFactory().newLeaf(node.label().labelFactory().newLabel(node.label())),null);
  }
  Tree newFoot=null;
  List<Tree> newChildren=new ArrayList<Tree>(node.children().length);
  for (  Tree child : node.children()) {
    Pair<Tree,Tree> newChild=copyHelper(child);
    newChildren.add(newChild.first());
    if (newChild.second() != null)     newFoot=newChild.second();
  }
  return new Pair<Tree,Tree>(node.treeFactory().newTreeNode(node.label().labelFactory().newLabel(node.label()),newChildren),newFoot);
}
