{
  String prevWord="**BEGIN**";
  if (pos > 0) {
    prevWord=(String)index.get(sequence[pos - 1]);
  }
  if (pos >= sequence.length - 1 || sequence[pos + 1] < 0) {
    for (int i=0; i < conditionalProbs.length; i++) {
      String word=(String)index.get(i);
      conditionalProbs[i]=logConditionalProbOfWord(prevWord,word);
    }
  }
 else {
    String nextWord=(String)index.get(sequence[pos + 1]);
    for (int i=0; i < conditionalProbs.length; i++) {
      String word=(String)index.get(i);
      conditionalProbs[i]=logConditionalProbOfWord(prevWord,word) + logConditionalProbOfWord(word,nextWord);
    }
  }
  return conditionalProbs;
}
