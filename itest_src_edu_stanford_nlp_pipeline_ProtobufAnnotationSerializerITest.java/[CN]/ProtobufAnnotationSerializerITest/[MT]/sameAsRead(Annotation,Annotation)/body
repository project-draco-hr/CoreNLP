{
  for (int i=0; i < doc.get(CoreAnnotations.SentencesAnnotation.class).size(); ++i) {
    CoreMap sentence=doc.get(CoreAnnotations.SentencesAnnotation.class).get(i);
    for (int k=0; k < sentence.get(CoreAnnotations.TokensAnnotation.class).size(); ++k) {
      CoreLabel token=sentence.get(CoreAnnotations.TokensAnnotation.class).get(k);
      if (doc.containsKey(CoreAnnotations.DocIDAnnotation.class)) {
        token.setDocID(doc.get(CoreAnnotations.DocIDAnnotation.class));
      }
      token.setSentIndex(i);
    }
    if (sentence.containsKey(CoreAnnotations.NumerizedTokensAnnotation.class)) {
      for (      CoreMap numerizedToken : sentence.get(CoreAnnotations.NumerizedTokensAnnotation.class)) {
        if (numerizedToken.containsKey(CoreAnnotations.TokensAnnotation.class)) {
          numerizedToken.set(CoreAnnotations.NormalizedNamedEntityTagAnnotation.class,numerizedToken.get(CoreAnnotations.TokensAnnotation.class).get(0).get(CoreAnnotations.NormalizedNamedEntityTagAnnotation.class));
          numerizedToken.set(CoreAnnotations.NamedEntityTagAnnotation.class,numerizedToken.get(CoreAnnotations.TokensAnnotation.class).get(0).get(CoreAnnotations.NamedEntityTagAnnotation.class));
        }
      }
    }
  }
  assertEquals("Re-read document is not the same as what was saved",doc,readDoc);
}
