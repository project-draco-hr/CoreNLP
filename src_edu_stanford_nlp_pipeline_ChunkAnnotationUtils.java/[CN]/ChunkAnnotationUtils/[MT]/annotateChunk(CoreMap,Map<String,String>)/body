{
  for (  String attr : attributes.keySet()) {
    String value=attributes.get(attr);
    AnnotationLookup.KeyLookup lookup=AnnotationLookup.getCoreKey(attr);
    if (attr != null) {
      if (value != null) {
        try {
          Class valueClass=AnnotationLookup.getValueType(lookup.coreKey);
          if (valueClass == String.class) {
            chunk.set(lookup.coreKey,value);
          }
 else {
            Method valueOfMethod=valueClass.getMethod("valueOf",String.class);
            if (valueOfMethod != null) {
              chunk.set(lookup.coreKey,valueOfMethod.invoke(valueClass,value));
            }
          }
        }
 catch (        Exception ex) {
          throw new RuntimeException("Unable to annotate attribute " + attr,ex);
        }
      }
 else {
        chunk.set(lookup.coreKey,null);
      }
    }
 else {
      throw new UnsupportedOperationException("Unknown attributes: " + attr);
    }
  }
}
