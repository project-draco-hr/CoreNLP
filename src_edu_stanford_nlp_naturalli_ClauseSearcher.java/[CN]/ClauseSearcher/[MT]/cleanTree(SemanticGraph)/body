{
  List<IndexedWord> toDelete=new ArrayList<>();
  for (  IndexedWord vertex : tree.vertexSet()) {
    char tag=vertex.backingLabel().tag().charAt(0);
    if (tag == '.' || tag == ',' || tag == '(' || tag == ')' || tag == ':') {
      toDelete.add(vertex);
    }
  }
  for (  IndexedWord v : toDelete) {
    tree.removeVertex(v);
  }
  Iterator<SemanticGraphEdge> iter=tree.edgeIterable().iterator();
  while (iter.hasNext()) {
    SemanticGraphEdge edge=iter.next();
    if (edge.getDependent().index() == edge.getGovernor().index()) {
      iter.remove();
    }
 else     if (edge.getRelation().toString().equals("punct")) {
      iter.remove();
    }
  }
  List<SemanticGraphEdge> extraEdges=new ArrayList<>();
  for (  SemanticGraphEdge edge : tree.edgeIterable()) {
    if (edge.isExtra()) {
      extraEdges.add(edge);
    }
  }
  for (  SemanticGraphEdge edge : extraEdges) {
    tree.removeEdge(edge);
  }
  for (  SemanticGraphEdge extraEdge : new ArrayList<>(extraEdges)) {
    for (    SemanticGraphEdge candidateAppos : tree.incomingEdgeIterable(extraEdge.getDependent())) {
      if (candidateAppos.getRelation().toString().equals("appos")) {
        extraEdges.add(new SemanticGraphEdge(extraEdge.getGovernor(),candidateAppos.getGovernor(),extraEdge.getRelation(),extraEdge.getWeight(),extraEdge.isExtra()));
      }
    }
    for (    SemanticGraphEdge candidateAppos : tree.outgoingEdgeIterable(extraEdge.getDependent())) {
      if (candidateAppos.getRelation().toString().equals("appos")) {
        extraEdges.add(new SemanticGraphEdge(extraEdge.getGovernor(),candidateAppos.getDependent(),extraEdge.getRelation(),extraEdge.getWeight(),extraEdge.isExtra()));
      }
    }
  }
  return extraEdges;
}
