{
  if (!isTraining)   throw new IllegalStateException("Not training, or training was already finalized");
}
