{
  applyParams(x);
  double negativeLogConditionalProb=-logConditionalLikelihood(trainDocs);
  double penalty=0;
  int index=0;
  for (int i=0; i < numStates; i++) {
    if (i == State.FINISHIDX) {
      continue;
    }
    State s=states[i];
    int numNonZeroTransitions=0;
    for (int j=0; j < numStates; j++) {
      if (nonZeroTransitions[i][j]) {
        numNonZeroTransitions++;
      }
    }
    double meanTransition=Math.log(1.0 / (numNonZeroTransitions));
    for (int j=0; j < s.transition.length; j++) {
      if (nonZeroTransitions[i][j]) {
        penalty+=Math.pow(x[index++] - meanTransition,2) / sigmaSquared;
      }
    }
    if (i != State.FINISHIDX && i != State.STARTIDX && !(s.emit instanceof ConstantEmitMap)) {
      int numNonZeroEmissions=0;
      for (int j=0; j < vocab.size(); j++) {
        if (nonZeroEmissions[i][j]) {
          numNonZeroEmissions++;
        }
      }
      double meanEmission=Math.log(1.0 / numNonZeroEmissions);
      for (int j=0; j < vocab.size(); j++) {
        if (nonZeroEmissions[i][j]) {
          penalty+=Math.pow(x[index++] - meanEmission,2) / sigmaSquared;
        }
      }
    }
  }
  if (monitor) {
    System.err.println(" - penalty: " + penalty);
  }
  negativeLogConditionalProb+=penalty;
  if (monitor) {
    System.err.println(" - negative log conditional prob + penalty: " + negativeLogConditionalProb);
  }
  if (monitor) {
    System.err.println("--> value = " + negativeLogConditionalProb);
  }
  return (negativeLogConditionalProb);
}
