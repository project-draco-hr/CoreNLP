{
  DocumentReaderAndWriter<IN> readerAndWriter;
  try {
    readerAndWriter=(DocumentReaderAndWriter<IN>)Class.forName(flags.readerAndWriter).newInstance();
  }
 catch (  Exception e) {
    throw new RuntimeException(String.format("Error loading flags.readerAndWriter: '%s'",flags.readerAndWriter),e);
  }
  readerAndWriter.init(flags);
  return readerAndWriter;
}
