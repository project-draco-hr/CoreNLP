{
  if (firstSize < 0) {
    firstSize=numLabels();
  }
 else   if (firstSize != numLabels()) {
    throw new RuntimeException("You cannot call indexOf after adding a label after getting an index!");
  }
  int fi=fIndex.indexOf(f.first());
  if (fi < 0) {
    return -1;
  }
  int offset=numFeatures.get(fi);
  Clique c=featureCliques.get(fi);
  Index<LabeledClique> labels=lIndex.get(c);
  if (labels == null) {
    return -1;
  }
  int li=labels.indexOf((LabeledClique)f.second());
  if (li < 0) {
    return -1;
  }
  return offset + li;
}
