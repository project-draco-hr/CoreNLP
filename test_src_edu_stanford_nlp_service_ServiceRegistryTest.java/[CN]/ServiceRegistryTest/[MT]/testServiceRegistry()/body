{
  File file=File.createTempFile("bob","");
  file.delete();
  ServiceRegistry registry=new ServiceRegistry(file);
  assertFalse(registry.hasService(SampleService.class.getName()));
  new Thread(registry.registerSocketService(new SampleService())).start();
  assertTrue(registry.hasService(SampleService.class.getName()));
  registry.registerSocketService(new SampleService());
  assertEquals(registry.getService(SampleService.class.getName()).apply("hi"),"HI");
  file.delete();
}
