{
  String modelName=config.getModel();
  MaxentTagger maxentTagger=new MaxentTagger();
  maxentTagger.init(config);
  TaggerExperiments samples=new TaggerExperiments(config,maxentTagger);
  TaggerFeatures feats=samples.getTaggerFeatures();
  System.err.println("Samples from " + config.getFile());
  System.err.println("Number of features: " + feats.size());
  Problem p=new Problem(samples,feats);
  LambdaSolveTagger prob=new LambdaSolveTagger(p,0.0001,0.00001,maxentTagger.fnumArr);
  maxentTagger.prob=prob;
  if (config.getSearch().equals("owlqn")) {
    CGRunner runner=new CGRunner(prob,config.getModel(),config.getSigmaSquared());
    runner.solveL1(config.getRegL1());
  }
 else   if (config.getSearch().equals("cg")) {
    CGRunner runner=new CGRunner(prob,config.getModel(),config.getSigmaSquared());
    runner.solveCG();
  }
 else   if (config.getSearch().equals("qn")) {
    CGRunner runner=new CGRunner(prob,config.getModel(),config.getSigmaSquared());
    runner.solveQN();
  }
 else {
    prob.improvedIterative(config.getIterations());
  }
  if (prob.checkCorrectness()) {
    System.err.println("Model is correct [empirical expec = model expec]");
  }
 else {
    System.err.println("Model is not correct");
  }
  maxentTagger.saveModel(modelName);
  System.err.println("Extractors list:");
  System.err.println(maxentTagger.extractors.toString() + "\nrare" + maxentTagger.extractorsRare.toString());
}
