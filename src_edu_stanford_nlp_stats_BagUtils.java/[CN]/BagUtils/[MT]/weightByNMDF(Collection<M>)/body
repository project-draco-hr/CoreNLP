{
  Object2DoubleCounter<E> weights=getNMDFWeights(getDocumentFrequencies(docs));
  for (  Map<E,Double> doc : docs) {
    double doctotal=0;
    for (    Map.Entry<E,Double> e : doc.entrySet()) {
      final double weight=e.getValue() * weights.getDouble(e.getKey());
      e.setValue(weight);
      doctotal+=weight;
    }
    for (    Map.Entry<E,Double> e : doc.entrySet()) {
      e.setValue(e.getValue() / doctotal);
    }
  }
}
