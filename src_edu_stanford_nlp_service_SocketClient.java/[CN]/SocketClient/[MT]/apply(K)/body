{
  if (!isConnected()) {
    throw new ServiceException("Attempt to process request on disconnected session");
  }
  Integer id=sendRequest(request);
  while (!processed.containsKey(id)) {
synchronized (processed) {
      try {
        processed.wait();
      }
 catch (      InterruptedException e) {
      }
    }
    if (!isConnected()) {
      throw new ServiceException("Unexepcted disconnection from server");
    }
  }
  V rv=processed.remove(id);
  if (rv instanceof SocketService.ServiceEvaluationException) {
    throw ((SocketService.ServiceEvaluationException)rv).exception;
  }
  return rv;
}
