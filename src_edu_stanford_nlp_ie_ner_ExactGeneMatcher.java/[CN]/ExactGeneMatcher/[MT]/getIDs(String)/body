{
  Set<String> ids=null;
  if (substringMatch) {
    ids=new HashSet<String>();
    Set<String> synonyms;
    if (caseSensitive) {
      synonyms=map.getSynonyms();
    }
 else {
      synonyms=lcMap.keySet();
      gene=gene.toLowerCase();
    }
    for (Iterator<String> iter=synonyms.iterator(); iter.hasNext(); ) {
      String synonym=iter.next();
      if (gene.indexOf(synonym) != -1) {
        if (caseSensitive) {
          ids.addAll(map.getIDs(synonym));
        }
 else {
          ids.addAll(lcMap.get(synonym));
        }
      }
 else       if (synonym.indexOf(gene) != -1 && isValidMatch(synonym,gene)) {
        if (caseSensitive) {
          ids.addAll(map.getIDs(synonym));
        }
 else {
          ids.addAll(lcMap.get(synonym));
        }
      }
    }
  }
 else {
    if (caseSensitive) {
      ids=map.getIDs(gene);
    }
 else {
      ids=lcMap.get(gene.toLowerCase());
    }
  }
  if (ids == null) {
    return new HashSet<String>();
  }
 else {
    return ids;
  }
}
