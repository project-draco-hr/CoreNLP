double[] dir
double[] fg
double[] x
Function func
