double[] dir
double[] fg
double[] x
QNInfo qn
Function func
