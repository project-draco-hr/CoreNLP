{
  tree=tree.prune(emptyFilter);
  tree=Tsurgeon.processPatternsOnTree(cleanup,tree);
  if (retainNER)   markSimpleNamedEntities(tree);
  TwoDimensionalCounter<String,String> unigramTagger=new TwoDimensionalCounter<String,String>();
  for (  Tree t : tree) {
    if (simplifiedTagset && t.isPreTerminal()) {
      CoreLabel label=(CoreLabel)t.label();
      String pos=label.value();
      pos=simplifyPOSTag(pos).intern();
      label.setValue(pos);
      label.setTag(pos);
    }
 else     if (aggressiveNormalization && isMultiWordCandidate(t)) {
      normalizeForMultiWord(t,tf);
    }
  }
  tree=expandElisions(tree);
  tree=expandCliticPronouns(tree);
  return tree;
}
