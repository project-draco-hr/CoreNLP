{
  Counter<CandidatePhrase> sims=new ClassicCounter<CandidatePhrase>(candidatePhrases.size());
  for (  CandidatePhrase p : candidatePhrases) {
    Counter<Integer> feat=wordClassClustersForPhrase.get(p);
    if (feat == null) {
      feat=wordClass(p.getPhrase(),p.getPhraseLemma());
      wordClassClustersForPhrase.put(p,feat);
    }
    double maxSim=Double.MIN_VALUE;
    if (feat.size() > 0) {
      for (      CandidatePhrase pos : CollectionUtils.union(constVars.getLearnedWords(label).keySet(),constVars.getSeedLabelDictionary().get(label))) {
        Counter<Integer> posfeat=wordClassClustersForPhrase.get(pos);
        if (posfeat.size() > 0) {
          double j=Counters.jaccardCoefficient(posfeat,feat);
          if (j > maxSim)           maxSim=j;
        }
      }
    }
    sims.setCount(p,maxSim);
    if (allMaxSim.get() < maxSim)     allMaxSim.set(maxSim);
  }
  return sims;
}
