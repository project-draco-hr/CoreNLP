{
  TableFactor result=this;
  for (  int i : neighborIndices) {
    if (i != variable)     result=result.maxOut(i);
  }
  double[] marginal=new double[getVariableSize(variable)];
  int[] assn=new int[]{0};
  for (; assn[0] < marginal.length; assn[0]++) {
    marginal[assn[0]]=result.getAssignmentLogValue(assn);
  }
  normalizeLogArr(marginal);
  return marginal;
}
