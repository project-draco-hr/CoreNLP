{
  double max=0.0;
  for (  int[] assignment : this) {
    double v=getAssignmentLogValue(assignment);
    if (v > max) {
      max=v;
    }
  }
  double sumExp=0.0;
  for (  int[] assignment : this) {
    sumExp+=FastMath.exp(getAssignmentLogValue(assignment) - max);
  }
  return sumExp * FastMath.exp(max);
}
