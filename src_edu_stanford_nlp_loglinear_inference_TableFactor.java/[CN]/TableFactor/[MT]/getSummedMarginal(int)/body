{
  boolean containsVariable=false;
  for (  int i : neighborIndices) {
    if (i == variable) {
      if (containsVariable) {
        System.out.println("Duplicate!" + Arrays.toString(neighborIndices));
      }
      assert(!containsVariable);
      containsVariable=true;
    }
  }
  assert(containsVariable);
  TableFactor result=this;
  for (  int i : neighborIndices) {
    if (i != variable)     result=result.sumOut(i);
  }
  assert(result.neighborIndices.length == 1);
  assert(result.neighborIndices[0] == variable);
  double[] marginal=new double[getVariableSize(variable)];
  int[] assn=new int[]{0};
  for (; assn[0] < marginal.length; assn[0]++) {
    marginal[assn[0]]=result.getAssignmentLogValue(assn);
  }
  normalizeLogArr(marginal);
  return marginal;
}
