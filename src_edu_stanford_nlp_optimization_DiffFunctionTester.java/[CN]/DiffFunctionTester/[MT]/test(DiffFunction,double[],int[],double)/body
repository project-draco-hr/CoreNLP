{
  System.err.print("Testing grad <");
  double[] testGrad=testGrad(f,x,ind,eps);
  System.err.println(">");
  double[] fullGrad=f.derivativeAt(x);
  double[] fGrad=new double[ind.length];
  for (int i=0; i < ind.length; i++) {
    fGrad[i]=fullGrad[ind[i]];
  }
  double[] diff=ArrayMath.pairwiseSubtract(testGrad,fGrad);
  System.err.println("1-norm:" + ArrayMath.norm_1(diff));
  System.err.println("2-norm:" + ArrayMath.norm(diff));
  System.err.println("inf-norm:" + ArrayMath.norm_inf(diff));
  System.err.println("pearson:" + ArrayMath.pearsonCorrelation(testGrad,fGrad));
  ArrayMath.standardize(fGrad);
  ArrayMath.standardize(testGrad);
  System.err.printf("test: %s\n",Arrays.toString(testGrad));
  System.err.printf("full: %s\n",Arrays.toString(fGrad));
}
