{
  double val=f.valueAt(x);
  double[] answer=new double[testIndices.length];
  for (int i=0; i < testIndices.length; i++) {
    x[testIndices[i]]+=eps;
    answer[i]=(f.valueAt(x) - val) / eps;
    x[testIndices[i]]-=eps;
    System.err.print(".");
  }
  return answer;
}
