{
  if (splitStates) {
    if (DEBUG()) {
      System.out.println("Pre-split betas");
      outputBetas();
    }
    splitBetas();
    if (DEBUG()) {
      System.out.println("Post-split betas");
      outputBetas();
    }
  }
  TwoDimensionalMap<String,String,double[][]> tempUnaryBetas=new TwoDimensionalMap<String,String,double[][]>();
  ThreeDimensionalMap<String,String,String,double[][][]> tempBinaryBetas=new ThreeDimensionalMap<String,String,String,double[][][]>();
  recalculateTemporaryBetas(splitStates,null,tempUnaryBetas,tempBinaryBetas);
  boolean converged=useNewBetas(!splitStates,tempUnaryBetas,tempBinaryBetas);
  if (DEBUG()) {
    outputBetas();
  }
  return converged;
}
