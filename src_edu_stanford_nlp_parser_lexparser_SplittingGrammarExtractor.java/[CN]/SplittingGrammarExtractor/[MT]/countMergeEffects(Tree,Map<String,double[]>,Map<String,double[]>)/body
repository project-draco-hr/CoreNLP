{
  IdentityHashMap<Tree,double[]> probIn=new IdentityHashMap<Tree,double[]>();
  IdentityHashMap<Tree,double[]> probOut=new IdentityHashMap<Tree,double[]>();
  IdentityHashMap<Tree,double[][]> unaryTransitions=new IdentityHashMap<Tree,double[][]>();
  IdentityHashMap<Tree,double[][][]> binaryTransitions=new IdentityHashMap<Tree,double[][][]>();
  recountTree(tree,false,probIn,probOut,unaryTransitions,binaryTransitions);
  for (  Tree child : tree.children()) {
    countMergeEffects(child,totalStateMass,deltaAnnotations,probIn,probOut);
  }
}
