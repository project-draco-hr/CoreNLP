{
  if (annotation.containsKey(CoreAnnotations.SentencesAnnotation.class)) {
    if (nThreads() != 1 || maxTime() > 0) {
      MulticoreWrapper<CoreMap,CoreMap> wrapper=new MulticoreWrapper<CoreMap,CoreMap>(nThreads(),new AnnotatorProcessor(annotation));
      if (maxTime() > 0) {
        wrapper.setMaxBlockTime(maxTime());
      }
      for (      CoreMap sentence : annotation.get(CoreAnnotations.SentencesAnnotation.class)) {
        wrapper.put(sentence);
        while (wrapper.peek()) {
          wrapper.poll();
        }
      }
      wrapper.join();
      while (wrapper.peek()) {
        wrapper.poll();
      }
    }
 else {
      for (      CoreMap sentence : annotation.get(CoreAnnotations.SentencesAnnotation.class)) {
        doOneSentence(annotation,sentence);
      }
    }
  }
 else {
    throw new RuntimeException("unable to find sentences in: " + annotation);
  }
}
