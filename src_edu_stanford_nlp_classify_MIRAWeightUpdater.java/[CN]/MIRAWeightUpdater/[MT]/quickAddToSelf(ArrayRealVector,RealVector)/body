{
  double[] data=v1.getDataRef();
  if (v2 instanceof ArrayRealVector) {
    double[] data2=((ArrayRealVector)v2).getDataRef();
    for (int i=0; i < data.length; i++) {
      data[i]+=data2[i];
    }
  }
 else {
    Iterator<Entry> itr=v2.sparseIterator();
    Entry e;
    while (itr.hasNext() && (e=itr.next()) != null) {
      data[e.getIndex()]+=e.getValue();
    }
  }
  return v1;
}
