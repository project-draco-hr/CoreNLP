{
  List<String> inputLines=readLines(input);
  initializeNameToColumnMapping(inputLines.get(0));
  inputLines.remove(0);
  Map<String,List<HITResult>> sentenceToHitResults=getHitResults(inputLines);
  int docId=0;
  int numRelations=0;
  for (  Map.Entry<String,List<HITResult>> hitResults : sentenceToHitResults.entrySet()) {
    String textContent=hitResults.getKey();
    NFLTokenizer tokenizer=new NFLTokenizer(textContent);
    List<CoreLabel> tokens=tokenizer.tokenize();
    Annotation relSent=new Annotation(textContent);
    List<CoreLabel> labels=tokens;
    relSent.set(CoreAnnotations.DocIDAnnotation.class,String.valueOf(docId++));
    relSent.set(CoreAnnotations.TokensAnnotation.class,labels);
    AnnotationUtils.addSentence(dataset,relSent);
    HashMap<Integer,EntityMention> seenMentions=new HashMap<Integer,EntityMention>();
    for (    HITResult result : hitResults.getValue()) {
      Counter<Integer> responses=result.getResponses();
      double positiveResponse=0;
      double negativeResponses=0;
      for (      int response : responses.keySet()) {
        double count=responses.getCount(response);
        if (response == 1) {
          positiveResponse+=count;
        }
 else {
          negativeResponses+=count;
        }
      }
      if (positiveResponse > negativeResponses) {
        logOrPrint("\n\n++++Adding relation and entities");
        String parsableRelation=result.parsableRelation;
        List<EntityMention> argCandidates=getEntityMentions(parsableRelation,relSent);
        List<EntityMention> actualArgs=new ArrayList<EntityMention>();
        for (        EntityMention arg : argCandidates) {
          int seenKey=(10000000 * arg.getExtentTokenStart() + arg.getExtentTokenEnd());
          EntityMention mention=seenMentions.get(seenKey);
          if (mention == null) {
            seenMentions.put(seenKey,arg);
            mention=arg;
          }
          actualArgs.add(mention);
        }
        AnnotationUtils.addEntityMentions(relSent,actualArgs);
        RelationMention relationMention=getRelationMention(parsableRelation,actualArgs,relSent);
        AnnotationUtils.addRelationMention(relSent,relationMention);
        numRelations++;
        logOrPrint(relationMention.toString());
        logOrPrint(result.sentence);
        logOrPrint(result.humanReadableRelation);
        logOrPrint(responses.toString());
      }
    }
  }
  logOrPrint("Added " + numRelations + " relations");
}
