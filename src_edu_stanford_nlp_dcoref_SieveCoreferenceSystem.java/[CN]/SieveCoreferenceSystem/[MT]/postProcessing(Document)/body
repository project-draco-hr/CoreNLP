{
  Set<IntTuple> removeSet=new HashSet<IntTuple>();
  Set<Integer> removeClusterSet=new HashSet<Integer>();
  for (  CorefCluster c : document.corefClusters.values()) {
    Set<Mention> removeMentions=new HashSet<Mention>();
    for (    Mention m : c.getCorefMentions()) {
      if (Constants.REMOVE_APPOSITION_PREDICATENOMINATIVES && ((m.appositions != null && m.appositions.size() > 0) || (m.predicateNominatives != null && m.predicateNominatives.size() > 0) || (m.relativePronouns != null && m.relativePronouns.size() > 0))) {
        removeMentions.add(m);
        removeSet.add(document.positions.get(m));
        m.corefClusterID=m.mentionID;
      }
    }
    c.corefMentions.removeAll(removeMentions);
    if (Constants.REMOVE_SINGLETONS && c.getCorefMentions().size() == 1) {
      removeClusterSet.add(c.clusterID);
    }
  }
  for (  int removeId : removeClusterSet) {
    document.corefClusters.remove(removeId);
  }
  for (  IntTuple pos : removeSet) {
    document.positions.remove(pos);
  }
}
