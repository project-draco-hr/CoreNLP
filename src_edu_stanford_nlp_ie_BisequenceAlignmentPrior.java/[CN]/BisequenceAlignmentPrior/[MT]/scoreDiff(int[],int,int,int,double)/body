{
  double newScore=score;
  if (alignmentMap.containsKey(position)) {
    List<Pair<Integer,Double>> posProbList=alignmentMap.get(position);
    for (    Pair<Integer,Double> posProb : posProbList) {
      int alignedPos=posProb.first();
      double alignedProb=posProb.second();
      int alignedLabel=sequence[alignedPos];
      double probFactor=1.0;
      if (flags.factorInAlignmentProb) {
        probFactor=alignedProb;
      }
      newScore-=probFactor * getAlignedWordPairScore(oldLabel,alignedLabel,position);
      newScore+=probFactor * getAlignedWordPairScore(newLabel,alignedLabel,position);
    }
  }
  return newScore;
}
