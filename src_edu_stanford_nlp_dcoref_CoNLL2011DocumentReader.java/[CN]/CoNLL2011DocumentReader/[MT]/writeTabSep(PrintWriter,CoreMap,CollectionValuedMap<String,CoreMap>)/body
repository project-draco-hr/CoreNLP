{
  HeadFinder headFinder=new ModCollinsHeadFinder();
  List<CoreLabel> sentenceAnno=sentence.get(CoreAnnotations.TokensAnnotation.class);
  Tree sentenceTree=sentence.get(TreeCoreAnnotations.TreeAnnotation.class);
  HashMap<Pair<Integer,Integer>,String> sentenceInfo=new HashMap<Pair<Integer,Integer>,String>();
  Set<Tree> sentenceSubTrees=sentenceTree.subTrees();
  sentenceTree.setSpans();
  HashMap<Pair<Integer,Integer>,Tree> treeSpanMap=new HashMap<Pair<Integer,Integer>,Tree>();
  HashMap<Pair<Integer,Integer>,List<Tree>> wordSpanMap=new HashMap<Pair<Integer,Integer>,List<Tree>>();
  for (Iterator<Tree> iter3=sentenceSubTrees.iterator(); iter3.hasNext(); ) {
    Tree ctree=iter3.next();
    IntPair span=ctree.getSpan();
    if (span != null) {
      treeSpanMap.put(Pair.makePair(span.getSource(),span.getTarget()),ctree);
      wordSpanMap.put(Pair.makePair(span.getSource(),span.getTarget()),ctree.getLeaves());
    }
  }
  String[][] finalSentence;
  finalSentence=new String[sentenceAnno.size()][];
  HashMap<Pair<Integer,Integer>,String> allHeads=new HashMap<Pair<Integer,Integer>,String>();
  int index=-1;
  for (Iterator<CoreLabel> iter=sentenceAnno.iterator(); iter.hasNext(); ) {
    index+=1;
    CoreLabel newAnno=iter.next();
    String word=newAnno.word();
    String tag=newAnno.tag();
    String cat=newAnno.ner();
    String coref=newAnno.get(CorefCoreAnnotations.CorefAnnotation.class);
    finalSentence[index]=new String[4];
    finalSentence[index][0]=word;
    finalSentence[index][1]=tag;
    finalSentence[index][2]=cat;
    finalSentence[index][3]=coref;
    if (coref == null) {
      sentenceInfo.put(Pair.makePair(index,index),coref);
      finalSentence[index][3]="O";
    }
 else {
      String[] allC=coref.split("\\|");
      for (int i=0; i < allC.length; i++) {
        String corefG=allC[i];
        Pair<Integer,Integer> mention=getMention(index,corefG,sentenceAnno);
        String head=null;
        if (include(pw,sentenceInfo,mention,corefG) == false) {
          sentenceInfo.put(mention,corefG);
          Tree mentionTree=treeSpanMap.get(mention);
          if (mentionTree != null) {
            head=mentionTree.headTerminal(headFinder).nodeString();
          }
 else           if (mention.first == mention.second) {
            head=word;
          }
          allHeads.put(mention,head);
        }
      }
      if (allHeads.values().contains(word)) {
        finalSentence[index][3]="MENTION";
      }
 else {
        finalSentence[index][3]="O";
      }
    }
  }
  for (int i=0; i < finalSentence.length; i++) {
    String[] wordInfo=finalSentence[i];
    if (i < finalSentence.length - 1) {
      String[] nextWordInfo=finalSentence[i + 1];
      if (nextWordInfo[3].equals("MENTION") && nextWordInfo[0].equals("'s")) {
        wordInfo[3]="MENTION";
        finalSentence[i + 1][3]="O";
      }
    }
    pw.println(wordInfo[0] + "\t" + wordInfo[1]+ "\t"+ wordInfo[2]+ "\t"+ wordInfo[3]);
  }
  pw.println("");
}
