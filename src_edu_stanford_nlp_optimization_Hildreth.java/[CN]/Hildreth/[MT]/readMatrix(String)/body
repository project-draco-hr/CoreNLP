{
  BufferedReader br=new BufferedReader(new FileReader(filename));
  List<List<Double>> rawValues=new ArrayList<List<Double>>();
  int rowLen=-1;
  for (String line=br.readLine(); line != null; line=br.readLine()) {
    String[] fields=line.split("\\s+");
    if (rowLen == -1) {
      rowLen=fields.length;
    }
 else     if (rowLen != fields.length) {
      throw new RuntimeException("Expected " + rowLen + " columns, but read "+ fields.length);
    }
    List<Double> row=new ArrayList<Double>(fields.length);
    for (    String field : fields) {
      row.add(Double.parseDouble(field));
    }
    rawValues.add(row);
  }
  RealMatrix m=new Array2DRowRealMatrix(rawValues.size(),rowLen);
  for (int i=0; i < m.getRowDimension(); i++) {
    for (int j=0; j < m.getColumnDimension(); j++) {
      m.setEntry(i,j,rawValues.get(i).get(j));
    }
  }
  return m;
}
