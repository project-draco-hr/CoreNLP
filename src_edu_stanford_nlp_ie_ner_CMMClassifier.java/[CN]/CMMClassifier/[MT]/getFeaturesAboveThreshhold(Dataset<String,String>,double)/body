{
  if (!(classifier instanceof LinearClassifier)) {
    throw new RuntimeException("Attempting to remove features based on weight from a non-linear classifier");
  }
  Index<String> featureIndex=dataset.featureIndex;
  Index<String> labelIndex=dataset.labelIndex;
  Index<String> features=new HashIndex<String>();
  Iterator<String> featureIt=featureIndex.iterator();
  LinearClassifier<String,String> lc=(LinearClassifier<String,String>)classifier;
  LOOP:   while (featureIt.hasNext()) {
    String f=featureIt.next();
    Iterator<String> labelIt=labelIndex.iterator();
    double smallest=Double.POSITIVE_INFINITY;
    double biggest=Double.NEGATIVE_INFINITY;
    while (labelIt.hasNext()) {
      String l=labelIt.next();
      double weight=lc.weight(f,l);
      if (weight < smallest) {
        smallest=weight;
      }
      if (weight > biggest) {
        biggest=weight;
      }
      if (biggest - smallest > thresh) {
        features.add(f);
        continue LOOP;
      }
    }
  }
  return features;
}
