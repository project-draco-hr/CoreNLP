{
  double[] r=new double[x.length];
  double logTotal=ArrayMath.logSum(x);
  for (int i=0; i < x.length; i++) {
    r[i]=x[i] - logTotal;
  }
  return r;
}
