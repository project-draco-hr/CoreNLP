{
  double lhood=0, old_lhood=-9999999999.99, fracImprov=1;
  for (int iter=0; iter < maxIter; iter++) {
    runMstep1(datasets,dataWeights);
    lhood=runEstep(0,dataSize,dataWeights,beta);
    runMstep2();
    if (iter > 0) {
      fracImprov=-(lhood - old_lhood) / old_lhood;
      if (iter % 1 == 0)       System.out.printf("iter: %d log-likelihood: %f old-likelihood: %f fractional Improvement: %f\n",iter,lhood,old_lhood,fracImprov);
    }
    if (fracImprov < 0) {
      System.err.printf("WARNING: log likelihood went down at iteration %d. old_lhood: %f, new_lhood: %f\n",iter,old_lhood,lhood);
    }
 else     if (fracImprov < convergence)     break;
    old_lhood=lhood;
  }
}
