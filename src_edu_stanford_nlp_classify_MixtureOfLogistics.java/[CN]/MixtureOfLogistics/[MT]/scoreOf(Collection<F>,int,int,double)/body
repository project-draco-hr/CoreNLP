{
  double sum=0;
  for (  F feature : c) {
    int f=datasets.get(component).featureIndex.indexOf(feature);
    if (f >= 0) {
      sum+=logisticWeights[component][f];
    }
  }
  if (label == 1)   sum=-sum;
  return beta * (-Math.log(1.0 + Math.exp(sum))) + logMixtureWeights[component];
}
