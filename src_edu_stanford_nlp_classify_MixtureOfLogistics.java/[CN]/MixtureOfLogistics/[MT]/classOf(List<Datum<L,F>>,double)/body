{
  double marginalLogLhood=0.0;
  for (int j=0; j < numComponents; j++) {
    double logCompLhood=0;
    Datum<L,F> datum=mixtureDatum.get(j);
    if (datum instanceof BasicDatum<?,?>)     logCompLhood=scoreOf(datum.asFeatures(),1,j,beta);
 else     if (datum instanceof RVFDatum<?,?>)     logCompLhood=scoreOf(((RVFDatum<L,F>)datum).asFeaturesCounter(),1,j,beta);
    if (j == 0)     marginalLogLhood=logCompLhood;
 else     marginalLogLhood=SloppyMath.logAdd(marginalLogLhood,logCompLhood);
  }
  if (Math.exp(marginalLogLhood) >= 0.5)   return datasets.get(0).labelIndex.get(1);
  return datasets.get(0).labelIndex.get(0);
}
