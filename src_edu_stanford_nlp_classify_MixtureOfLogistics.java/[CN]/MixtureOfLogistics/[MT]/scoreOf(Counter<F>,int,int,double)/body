{
  double sum=0;
  for (  F feature : c.keySet()) {
    int f=datasets.get(component).featureIndex.indexOf(feature);
    if (f >= 0) {
      double val=c.getCount(feature);
      sum+=logisticWeights[component][f] * val;
    }
  }
  if (label == 1)   sum=-sum;
  return beta * (-Math.log(1.0 + Math.exp(sum))) + logMixtureWeights[component];
}
