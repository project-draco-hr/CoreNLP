{
  TreeMap<String,String> result=new TreeMap<String,String>();
  for (int i=0; i < args.length; i++) {
    String key=args[i];
    if (key.length() > 0 && key.charAt(0) == '-') {
      if (key.length() > 1 && key.charAt(1) == '-')       key=key.substring(2);
 else       key=key.substring(1);
      if (key.equalsIgnoreCase(PROP) || key.equalsIgnoreCase(PROPS) || key.equalsIgnoreCase(PROPERTIES)|| key.equalsIgnoreCase(ARGUMENTS)|| key.equalsIgnoreCase(ARGS)) {
        result.putAll(propFileToTreeMap(args[i + 1]));
        i++;
      }
    }
  }
  for (  Entry<String,String> o : result.entrySet()) {
    String val=resolveVars(o.getValue(),result);
    result.put(o.getKey(),val);
  }
  Properties props=new Properties();
  props.putAll(result);
  return props;
}
