{
  try {
    if (args.length < 1 || args.length > 4) {
      System.err.println("usage: java SeeChars file [inCharEncoding [outCharEncoding [nonAscii]]]");
    }
 else {
      String inEncoding=System.getProperty("file.encoding");
      String outEncoding;
      if (args.length < 3) {
        System.out.println("Using system default character encoding \"" + inEncoding + "\" for not explicitly specified encodings");
        if (args.length > 1) {
          inEncoding=args[1];
        }
        outEncoding=inEncoding;
      }
 else {
        inEncoding=args[1];
        outEncoding=args[2];
        System.out.println("Input encoding is " + inEncoding + " and output encoding is "+ outEncoding);
      }
      boolean onlyNonAscii=args.length > 3;
      Reader r=new BufferedReader(new InputStreamReader(new FileInputStream(args[0]),inEncoding));
      PrintWriter pw=new PrintWriter(new OutputStreamWriter(System.out,outEncoding),true);
      int ch;
      int pos=0;
      while ((ch=r.read()) >= 0) {
        if (ch >= 0 && Character.isHighSurrogate((char)ch)) {
          int ch2=r.read();
          if (ch2 >= 0) {
            ch=Character.toCodePoint((char)ch,(char)ch2);
          }
        }
        if (!onlyNonAscii) {
          seeCodePoint(ch,pw);
        }
 else         if (ch > 127) {
          pw.print("Offset " + pos + ": ");
          seeCodePoint(ch,pw);
        }
        pos++;
      }
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
