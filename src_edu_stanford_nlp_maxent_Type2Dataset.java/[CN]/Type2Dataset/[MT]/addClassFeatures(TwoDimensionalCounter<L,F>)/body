{
  for (  L thisClass : classFeatures.firstKeySet()) {
    Counter<F> thisClassFeatures=classFeatures.getCounter(thisClass);
    classIndex.add(thisClass);
    int thisIntClass=classIndex.indexOf(thisClass);
    IntPair instance=new IntPair(size,thisIntClass);
    instanceIndex.add(instance);
    int intInstance=instanceIndex.indexOf(instance);
    for (    F thisFeature : thisClassFeatures.keySet()) {
      double thisFeatureValue=thisClassFeatures.getCount(thisFeature);
      if (thisFeatureValue == 0) {
        continue;
      }
      featureIndex.add(thisFeature);
      int thisIntFeature=featureIndex.indexOf(thisFeature);
      ensureFeatureIndexSize(thisIntFeature);
      featureInstances[thisIntFeature][featureArraySizes[thisIntFeature]]=intInstance;
      featureInstanceValues[thisIntFeature][featureArraySizes[thisIntFeature]]=thisFeatureValue;
      featureArraySizes[thisIntFeature]++;
    }
  }
}
