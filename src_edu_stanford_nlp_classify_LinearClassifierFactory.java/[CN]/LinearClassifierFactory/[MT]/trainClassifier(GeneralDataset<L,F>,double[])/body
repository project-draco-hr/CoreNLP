{
  if (dataset instanceof RVFDataset)   ((RVFDataset<L,F>)dataset).ensureRealValues();
  double[][] weights=trainWeights(dataset,initial,false);
  LinearClassifier<L,F> classifier=new LinearClassifier<L,F>(weights,dataset.featureIndex(),dataset.labelIndex());
  return classifier;
}
