{
  Minimizer<DiffFunction> minimizer=getMinimizer();
  Index<F> featureIndex=Generics.newIndex();
  Index<L> labelIndex=Generics.newIndex();
  for (  Datum<L,F> d : dataIterable) {
    labelIndex.add(d.label());
    featureIndex.addAll(d.asFeatures());
  }
  Logging.logger(this.getClass()).info(String.format("Training linear classifier with %d features and %d labels",featureIndex.size(),labelIndex.size()));
  LogConditionalObjectiveFunction<L,F> objective=new LogConditionalObjectiveFunction<L,F>(dataIterable,logPrior,featureIndex,labelIndex);
  double[] initial=objective.initial();
  double[] weights=minimizer.minimize(objective,TOL,initial);
  LinearClassifier<L,F> classifier=new LinearClassifier<L,F>(objective.to2D(weights),featureIndex,labelIndex);
  return classifier;
}
