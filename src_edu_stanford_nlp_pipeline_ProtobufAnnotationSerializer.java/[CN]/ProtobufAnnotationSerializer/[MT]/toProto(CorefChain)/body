{
  CoreMapProtos.CorefChain.Builder builder=CoreMapProtos.CorefChain.newBuilder();
  builder.setChainID(chain.getChainID());
  Map<CorefChain.CorefMention,Integer> mentionToIndex=new IdentityHashMap<CorefChain.CorefMention,Integer>();
  for (  Map.Entry<IntPair,Set<CorefChain.CorefMention>> entry : chain.getMentionMap().entrySet()) {
    for (    CorefChain.CorefMention mention : entry.getValue()) {
      mentionToIndex.put(mention,mentionToIndex.size());
      builder.addMention(CoreMapProtos.CorefChain.CorefMention.newBuilder().setMentionID(mention.mentionID).setMentionType(mention.mentionType.name()).setNumber(mention.number.name()).setGender(mention.gender.name()).setAnimacy(mention.animacy.name()).setStartIndex(mention.startIndex).setEndIndex(mention.endIndex).setHeadIndex(mention.headIndex));
    }
  }
  builder.setRepresentative(mentionToIndex.get(chain.getRepresentativeMention()));
  return builder.build();
}
