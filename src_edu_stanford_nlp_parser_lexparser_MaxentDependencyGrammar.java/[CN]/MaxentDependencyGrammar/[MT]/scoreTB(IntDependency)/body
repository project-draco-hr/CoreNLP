{
  depDumpPrintln("Scoring dependency: " + dep);
  double pb_stop=getStopProb(dep);
  if (dep.arg.word == -2) {
    if (rootTW(dep.head)) {
      return 0.0;
    }
    depDumpPrintf("Stop score: %5g\n",Math.log(pb_stop));
    return op.testOptions.depWeight * Math.log(pb_stop);
  }
  double pb_go=rootTW(dep.head) ? 1.0 : 1.0 - pb_stop;
  depDumpPrintf("Go score: %5g\n",Math.log(pb_go));
  double smoothProb=getDepProb(dep);
  double score=op.testOptions.depWeight * Math.log(smoothProb * pb_go);
  depDumpPrintf("Smooth score: %5g\n",score);
  return score;
}
