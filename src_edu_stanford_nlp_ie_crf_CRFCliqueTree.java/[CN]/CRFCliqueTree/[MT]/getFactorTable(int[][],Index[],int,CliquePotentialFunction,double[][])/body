{
  FactorTable factorTable=null;
  for (int j=0; j < labelIndices.length; j++) {
    Index labelIndex=labelIndices[j];
    FactorTable ft=new FactorTable(numClasses,j + 1);
    double[] featureVal=null;
    if (featureValByCliqueSize != null)     featureVal=featureValByCliqueSize[j];
    for (int k=0, liSize=labelIndex.size(); k < liSize; k++) {
      int[] label=((CRFLabel)labelIndex.get(k)).getLabel();
      double cliquePotential=cliquePotentialFunc.computeCliquePotential(j + 1,k,data[j],featureVal);
      ft.setValue(label,cliquePotential);
    }
    if (j > 0) {
      ft.multiplyInEnd(factorTable);
    }
    factorTable=ft;
  }
  return factorTable;
}
