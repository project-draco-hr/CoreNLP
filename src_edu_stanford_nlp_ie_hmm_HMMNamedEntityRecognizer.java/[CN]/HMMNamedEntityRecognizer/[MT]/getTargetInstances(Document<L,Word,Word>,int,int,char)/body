{
  List<String> targetInstances=new ArrayList<String>();
  boolean inTargetWord=false;
  boolean startedTarget;
  StringBuffer sb=new StringBuffer();
  for (int i=0; i < numLeftContextChars; i++) {
    sb.append(startSymbol);
  }
  for (int i=0; i < doc.size(); i++) {
    TypedTaggedWord ttw=(TypedTaggedWord)doc.get(i);
    int type=ttw.type();
    String word=ttw.word();
    startedTarget=false;
    if (type == targetType) {
      if (!inTargetWord) {
        sb.delete(0,sb.length() - numLeftContextChars + (i > 0 ? 1 : 0));
        inTargetWord=true;
        startedTarget=true;
      }
    }
 else     if (inTargetWord) {
      targetInstances.add(sb.toString());
      inTargetWord=false;
    }
    if (!word.equals(ADJACENT)) {
      if (i > 0) {
        sb.append(startedTarget ? startSymbol : ' ');
      }
      sb.append(word);
    }
  }
  if (inTargetWord) {
    targetInstances.add(sb.toString());
  }
  return targetInstances.toArray(new String[0]);
}
