{
  model.setParameters(weights,weightsScale);
  for (int datumNum=0; datumNum < doc.features.length; datumNum++) {
    LabeledClique trueMaxCliqueLabel=doc.maxCliqueLabels[datumNum];
    value-=model.logProbOf(datumNum,trueMaxCliqueLabel);
  }
  model.clearFactors();
  return value;
}
