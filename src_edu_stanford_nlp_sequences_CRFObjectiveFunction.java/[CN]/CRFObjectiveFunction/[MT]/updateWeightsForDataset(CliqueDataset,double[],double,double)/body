{
  for (int datumNum=0; datumNum < data.features.length; datumNum++) {
    Features d=data.features[datumNum].get(data.maxCliqueLabels[datumNum]);
    int[] features=d.features;
    for (int f=0; f < features.length; f++) {
      weights[features[f]]+=gain * d.value(f);
    }
  }
}
