{
  if (EhatStochastic == null) {
    EhatStochastic=new double[numFeatures];
  }
 else {
    Arrays.fill(EhatStochastic,0.0);
  }
  for (int b=0; b < batch.length; b++) {
    int docNum=batch[b];
    CliqueDataset data=dataset.getDocument(docNum);
    updateEhatForDataset(EhatStochastic,data);
  }
  for (int i=0; i < derivative.length; i++) {
    derivative[i]=E[i] - EhatStochastic[i];
  }
}
