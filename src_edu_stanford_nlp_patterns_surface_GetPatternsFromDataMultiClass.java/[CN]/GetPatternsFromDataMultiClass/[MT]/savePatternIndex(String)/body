{
  if (constVars.allPatternsDir != null && !patsForEachToken.getUseDBForTokenPatterns()) {
    IOUtils.ensureDir(new File(dir));
    patsForEachToken.writePatternsIfInMemory(dir + "/allpatterns.ser");
    IOUtils.writeObjectToFile(constVars.getPatternIndex(),dir + "/patternshashindex.ser");
  }
 else   if (patsForEachToken.getUseDBForTokenPatterns()) {
    patsForEachToken.savePatternIndexInDB(constVars.getPatternIndex());
  }
}
